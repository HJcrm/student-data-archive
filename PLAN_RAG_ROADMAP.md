# RAG κΈ°λ° μƒκΈ°λ¶€ λ΅λ“λ§µ μƒμ„± μ‹μ¤ν… κ°λ° κ³„ν

## 1. ν”„λ΅μ νΈ κ°μ”

### λ©ν‘
ν•™μƒμ μ„±μ λ€, ν¬λ§κ³„μ—΄, ν•™κµ νΉμ„±μ„ μ…λ ¥λ°›μ•„ μ•„μΉ΄μ΄λΉ™λ ν•©κ²©μ λ°μ΄ν„°λ¥Ό κΈ°λ°μΌλ΅ **λ§μ¶¤ν• ν•™λ…„λ³„ μƒκΈ°λ¶€ λ΅λ“λ§µ**μ„ μƒμ„±ν•λ” RAG μ‹μ¤ν…

### ν•µμ‹¬ κΈ°λ¥
1. μ μ‚¬ ν•©κ²© μ‚¬λ΅€ κ²€μƒ‰ (μ„±μ /κ³„μ—΄/ν•™κµ μ ν• κΈ°λ°)
2. μ‹κΈ°λ³„ νƒκµ¬ν™λ™ μ¶”μ²
3. νƒκµ¬ν™λ™κ³Ό λ§¤μΉ­λλ” μ„ΈνΉ μμ‹ μ κ³µ
4. ν•™λ…„λ³„ λ΅λ“λ§µ μƒμ„±

---

## 2. λ°μ΄ν„° κµ¬μ΅° μ„¤κ³„

### 2.1 ν•™μƒ ν”„λ΅ν•„ (κ²€μƒ‰/ν•„ν„°λ§μ© λ©”νƒ€λ°μ΄ν„°)

```python
class StudentProfile:
    """ν•©κ²©μ λΌλ²¨λ§ μ§€ν‘"""
    id: str                      # κ³ μ  μ‹λ³„μ
    source_file: str             # μ›λ³Έ PDF νμΌλ…

    # μ„±μ  μ§€ν‘
    grade_type: str              # "λ‚΄μ‹ ν•" | "μλ¥ν•" | "κ· ν•ν•"
    nesin_average: float         # λ‚΄μ‹  ν‰κ·  λ“±κΈ‰ (1.0 ~ 9.0)
    nesin_range: str             # "1λ“±κΈ‰λ€" | "2λ“±κΈ‰λ€" | "3λ“±κΈ‰λ€"

    # μ§„ν•™ μ •λ³΄
    final_university: str        # μµμΆ… μ§„ν•™ λ€ν•™
    final_department: str        # μµμΆ… μ§„ν•™ ν•™κ³Ό
    university_tier: str         # "SKY" | "μΈμ„μΈμƒμ„" | "μΈμ„μΈ" | "μ§€λ°©κ±°μ "

    # κ³„μ—΄ μ •λ³΄
    major_field: str             # "κ²½μ/κ²½μ " | "μΈλ¬Έ" | "μ‚¬ν" | "μμ—°" | "κ³µν•™" | "μμ•½"

    # ν•™κµ νΉμ„±
    school_type: str             # "μΌλ°κ³ " | "μμ‚¬κ³ " | "νΉλ©κ³ " | "μμ¬κ³ "
    school_region: str           # μ§€μ—­
    competition_level: str       # "λ†’μ" | "λ³΄ν†µ" | "λ‚®μ"
```

### 2.2 νƒκµ¬ν™λ™ (RAG κ²€μƒ‰ λ€μƒ)

```python
class ResearchActivity:
    """μ‹κΈ°λ³„ ν•µμ‹¬ νƒκµ¬ν™λ™"""
    id: str                      # κ³ μ  μ‹λ³„μ
    student_id: str              # ν•™μƒ ν”„λ΅ν•„ μ°Έμ΅°

    # μ‹κΈ° μ •λ³΄
    term: str                    # "1-1" | "1-2" | "2-1" | "2-2" | "3-1"
    grade: int                   # 1 | 2 | 3
    semester: int                # 1 | 2

    # ν™λ™ μ •λ³΄
    subject: str                 # κ³Όλ©λ… (μ„Έκ³„μ§€λ¦¬, κ²½μ , μμ–΄λ…ν•΄μ™€μ‘λ¬Έ λ“±)
    title: str                   # νƒκµ¬ μ£Όμ 

    # λ¶„λ¥ νƒκ·Έ
    keywords: list[str]          # ν‚¤μ›λ“ (μλ™ μ¶”μ¶)
    theme: str                   # μ „μ²΄ ν…λ§ (κ²½μ/κ²½μ  μ‹¬ν™” νƒκµ¬ λ“±)

    # μ—°κ²°λ μ„ΈνΉ
    linked_saeteuk_id: str       # λ§¤μΉ­λ μ„ΈνΉ ID (μλ” κ²½μ°)

    # μ„λ² λ”©
    embedding: list[float]       # λ²΅ν„° μ„λ² λ”© (1536μ°¨μ›, OpenAI ada-002)
```

### 2.3 μ„ΈνΉ μμ‹ (RAG κ²€μƒ‰ λ€μƒ)

```python
class SaeteukExample:
    """μ„Έλ¶€λ¥λ ¥νΉκΈ°μ‚¬ν•­ μμ‹"""
    id: str                      # κ³ μ  μ‹λ³„μ
    student_id: str              # ν•™μƒ ν”„λ΅ν•„ μ°Έμ΅°

    # κ³Όλ© μ •λ³΄
    subject: str                 # κ³Όλ©λ…
    term: str                    # ν•™κΈ° (μ¶”μ •)

    # λ‚΄μ©
    content: str                 # μ„ΈνΉ μ „μ²΄ λ‚΄μ©
    highlights: list[str]        # ν•µμ‹¬ ν¬μΈνΈ

    # μ—°κ²°λ νƒκµ¬ν™λ™
    linked_research_ids: list[str]  # λ§¤μΉ­λ νƒκµ¬ν™λ™ IDλ“¤

    # μ„λ² λ”©
    embedding: list[float]       # λ²΅ν„° μ„λ² λ”©
```

### 2.4 λ°μ΄ν„° κ΄€κ³„λ„

```
StudentProfile (1) β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€ (N) ResearchActivity
                         β”‚              β”‚
                         β”‚              β”‚ linked_saeteuk_id
                         β”‚              β–Ό
                         β””β”€β”€β”€β”€β”€β”€ (N) SaeteukExample
```

---

## 3. μ €μ¥μ† κµ¬μ΅°

### 3.1 λ²΅ν„° λ°μ΄ν„°λ² μ΄μ¤ (ChromaDB κ¶μ¥)

```
collections/
β”β”€β”€ research_activities     # νƒκµ¬ν™λ™ λ²΅ν„° + λ©”νƒ€λ°μ΄ν„°
β””β”€β”€ saeteuk_examples        # μ„ΈνΉ μμ‹ λ²΅ν„° + λ©”νƒ€λ°μ΄ν„°
```

### 3.2 λ©”νƒ€λ°μ΄ν„° μ €μ¥μ† (SQLite λλ” JSON)

```
data/
β”β”€β”€ students.json           # ν•™μƒ ν”„λ΅ν•„ (ν•„ν„°λ§μ©)
β”β”€β”€ research.json           # νƒκµ¬ν™λ™ μ›λ³Έ λ°μ΄ν„°
β”β”€β”€ saeteuk.json            # μ„ΈνΉ μ›λ³Έ λ°μ΄ν„°
β””β”€β”€ links.json              # νƒκµ¬-μ„ΈνΉ μ—°κ²° μ •λ³΄
```

### 3.3 ν”„λ΅μ νΈ κµ¬μ΅° (ν™•μ¥)

```
ν•©κ²©μ λ°μ΄ν„° μ•„μΉ΄μ΄λΉ™/
β”β”€β”€ main.py                 # κΈ°μ΅΄ PDF νμ‹±
β”β”€β”€ config.py
β”β”€β”€ src/
β”‚   β”β”€β”€ parser/             # κΈ°μ΅΄ νμ„
β”‚   β”β”€β”€ extractor/          # κΈ°μ΅΄ μ¶”μ¶κΈ°
β”‚   β””β”€β”€ ...
β”β”€β”€ rag/                    # π†• RAG μ‹μ¤ν…
β”‚   β”β”€β”€ __init__.py
β”‚   β”β”€β”€ schema.py           # λ°μ΄ν„° μ¤ν‚¤λ§ (Pydantic)
β”‚   β”β”€β”€ indexer.py          # λ²΅ν„° μΈλ±μ‹±
β”‚   β”β”€β”€ retriever.py        # κ²€μƒ‰ λ΅μ§
β”‚   β”β”€β”€ generator.py        # λ΅λ“λ§µ μƒμ„±
β”‚   β””β”€β”€ api.py              # FastAPI μ—”λ“ν¬μΈνΈ
β”β”€β”€ data/                   # π†• RAG λ°μ΄ν„°
β”‚   β”β”€β”€ vectordb/           # ChromaDB μ €μ¥μ†
β”‚   β””β”€β”€ metadata/           # JSON λ©”νƒ€λ°μ΄ν„°
β””β”€β”€ output/                 # νμ‹± κ²°κ³Ό
```

---

## 4. κ°λ° λ‹¨κ³„

### Phase 1: λ°μ΄ν„° μ¤ν‚¤λ§ λ° λ³€ν™ (1μ£Ό)

**λ©ν‘**: κΈ°μ΅΄ νμ‹± κ²°κ³Όλ¥Ό RAGμ© λ°μ΄ν„° κµ¬μ΅°λ΅ λ³€ν™

**μ‘μ—… λ‚΄μ©**:
1. `rag/schema.py` - Pydantic λ¨λΈ μ •μ
2. `rag/converter.py` - κΈ°μ΅΄ JSON β†’ RAG μ¤ν‚¤λ§ λ³€ν™
3. ν•™μƒ ν”„λ΅ν•„ μλ™ μ¶”μ¶ λ΅μ§
   - λ‚΄μ‹  ν‰κ·  κ³„μ‚°
   - λ€ν•™ ν‹°μ–΄ λ¶„λ¥
   - κ³„μ—΄ μλ™ λ¶„λ¥

**μ‚°μ¶λ¬Ό**:
- `data/metadata/students.json`
- `data/metadata/research.json`
- `data/metadata/saeteuk.json`

---

### Phase 2: λ²΅ν„° μΈλ±μ‹± (1μ£Ό)

**λ©ν‘**: νƒκµ¬ν™λ™κ³Ό μ„ΈνΉμ„ λ²΅ν„° DBμ— μΈλ±μ‹±

**μ‘μ—… λ‚΄μ©**:
1. `rag/indexer.py` - λ²΅ν„° μΈλ±μ‹± λ΅μ§
2. OpenAI Embedding API μ—°λ™ (text-embedding-ada-002)
3. ChromaDB μ»¬λ ‰μ… μƒμ„± λ° λ°μ΄ν„° μ‚½μ…
4. λ©”νƒ€λ°μ΄ν„° ν•„ν„° μ„¤μ •

**μΈλ±μ‹± λ€μƒ**:
```python
# νƒκµ¬ν™λ™: μ λ© + κ³Όλ© + ν‚¤μ›λ“
text = f"{research.title} | κ³Όλ©: {research.subject} | ν‚¤μ›λ“: {', '.join(research.keywords)}"

# μ„ΈνΉ: μ „μ²΄ λ‚΄μ© (μ²­ν‚Ή ν•„μ”μ‹ λ¶„ν• )
text = saeteuk.content
```

**μ‚°μ¶λ¬Ό**:
- `data/vectordb/` (ChromaDB νμΌ)

---

### Phase 3: κ²€μƒ‰ λ΅μ§ κµ¬ν„ (1μ£Ό)

**λ©ν‘**: μ‚¬μ©μ μ…λ ¥ κΈ°λ° μ μ‚¬ μ‚¬λ΅€ κ²€μƒ‰

**μ‘μ—… λ‚΄μ©**:
1. `rag/retriever.py` - κ²€μƒ‰ λ΅μ§
2. 2λ‹¨κ³„ κ²€μƒ‰ κµ¬ν„:
   - 1λ‹¨κ³„: λ©”νƒ€λ°μ΄ν„° ν•„ν„°λ§ (μ„±μ λ€, κ³„μ—΄, ν•™κµμ ν•)
   - 2λ‹¨κ³„: λ²΅ν„° μ μ‚¬λ„ κ²€μƒ‰

**κ²€μƒ‰ μΏΌλ¦¬ μμ‹**:
```python
def search_similar_cases(
    grade_range: str,        # "2λ“±κΈ‰λ€"
    major_field: str,        # "κ²½μ/κ²½μ "
    school_type: str,        # "μΌλ°κ³ "
    target_term: str = None, # "2-1" (μ„ νƒ)
    top_k: int = 5
) -> list[SearchResult]:
    ...
```

**μ‚°μ¶λ¬Ό**:
- κ²€μƒ‰ API ν•¨μ

---

### Phase 4: λ΅λ“λ§µ μƒμ„± (1μ£Ό)

**λ©ν‘**: κ²€μƒ‰ κ²°κ³Ό κΈ°λ° λ§μ¶¤ν• λ΅λ“λ§µ μƒμ„±

**μ‘μ—… λ‚΄μ©**:
1. `rag/generator.py` - GPT κΈ°λ° λ΅λ“λ§µ μƒμ„±
2. ν”„λ΅¬ν”„νΈ μ—”μ§€λ‹μ–΄λ§
3. ν•™λ…„λ³„ κµ¬μ΅°ν™”λ μ¶λ ¥

**μƒμ„± ν”„λ΅¬ν”„νΈ κµ¬μ΅°**:
```
[μ‹μ¤ν…]
λ‹Ήμ‹ μ€ λ€μ… μ»¨μ„¤ν„΄νΈμ…λ‹λ‹¤. μ μ‚¬ ν•©κ²© μ‚¬λ΅€λ¥Ό μ°Έκ³ ν•μ—¬
ν•™μƒ λ§μ¶¤ν• μƒκΈ°λ¶€ λ΅λ“λ§µμ„ μ‘μ„±ν•μ„Έμ”.

[μ‚¬μ©μ μ •λ³΄]
- ν„μ¬ ν•™λ…„: 1ν•™λ…„
- λ©ν‘ μ„±μ λ€: 2λ“±κΈ‰λ€
- ν¬λ§ κ³„μ—΄: κ²½μ/κ²½μ 
- ν•™κµ μ ν•: μΌλ°κ³ 

[μ°Έκ³ ν•  ν•©κ²© μ‚¬λ΅€]
## μ‚¬λ΅€ 1: κ³ λ ¤λ€ν•™κµ κ²½μν•™κ³Ό ν•©κ²©
- λ‚΄μ‹ : 1.6λ“±κΈ‰
- νƒκµ¬ν™λ™:
  - 1-1 ν•κµ­μ‚¬: μ΅°μ„  ν›„κΈ° μ†΅μƒμ μƒμ—… λ„¤νΈμ›ν¬ λ¶„μ„
  - 2-1 κ²½μ : λ―Έκµ­ μΈν”λ μ΄μ… κ°μ¶•λ²•μ΄ μ°λ¦¬λ‚λΌ μ‚°μ—…μ— λ―ΈμΉλ” μν–¥
  ...
- μ„ΈνΉ μμ‹:
  [μ„Έκ³„μ§€λ¦¬] λ¬μ‹μ•„-μ°ν¬λΌμ΄λ‚ μ „μμ΄ μ„Έκ³„ κ³΅λ¬Όμ‹μ¥μ— λ―ΈμΉ μν–¥...

[μ¶λ ¥ ν•μ‹]
ν•™λ…„λ³„λ΅ μ¶”μ² νƒκµ¬ μ£Όμ μ™€ μ„ΈνΉ μ‘μ„± λ°©ν–¥μ„ μ μ‹ν•μ„Έμ”.
```

**μ‚°μ¶λ¬Ό**:
- λ§ν¬λ‹¤μ΄ ν•μ‹ λ΅λ“λ§µ

---

### Phase 5: API λ° μΈν„°νμ΄μ¤ (1μ£Ό)

**λ©ν‘**: μ‚¬μ©μ μΈν„°νμ΄μ¤ κµ¬ν„

**μ‘μ—… λ‚΄μ©**:
1. `rag/api.py` - FastAPI μ—”λ“ν¬μΈνΈ
2. CLI μΈν„°νμ΄μ¤ μ¶”κ°€
3. (μ„ νƒ) Streamlit μ›Ή UI

**API μ—”λ“ν¬μΈνΈ**:
```python
POST /api/roadmap
{
    "grade": 1,
    "target_grade_range": "2λ“±κΈ‰λ€",
    "major_field": "κ²½μ/κ²½μ ",
    "school_type": "μΌλ°κ³ ",
    "interests": ["ESG", "κΈμµ", "μ¤νƒ€νΈμ—…"]  # μ„ νƒ
}

Response:
{
    "roadmap": {
        "1ν•™λ…„": {...},
        "2ν•™λ…„": {...},
        "3ν•™λ…„": {...}
    },
    "reference_cases": [...],
    "recommended_activities": [...]
}
```

---

## 5. κΈ°μ  μ¤νƒ

| κµ¬λ¶„ | κΈ°μ  | μ©λ„ |
|------|------|------|
| λ²΅ν„° DB | ChromaDB | μ„λ² λ”© μ €μ¥/κ²€μƒ‰ |
| μ„λ² λ”© | OpenAI text-embedding-ada-002 | ν…μ¤νΈ λ²΅ν„°ν™” |
| LLM | GPT-4o-mini | λ΅λ“λ§µ μƒμ„± |
| λ°±μ—”λ“ | FastAPI | API μ„λ²„ |
| λ°μ΄ν„° | Pydantic + JSON | μ¤ν‚¤λ§ λ° μ €μ¥ |
| (μ„ νƒ) UI | Streamlit | μ›Ή μΈν„°νμ΄μ¤ |

---

## 6. μμƒ λΉ„μ©

| ν•­λ© | λ‹¨κ°€ | μμƒ μ‚¬μ©λ‰ | μ›” λΉ„μ© |
|------|------|-------------|---------|
| μ„λ² λ”© (ada-002) | $0.0001/1K tokens | 100κ° νμΌ Γ— 5K tokens | ~$0.05 |
| GPT-4o-mini | $0.15/1M input | λ΅λ“λ§µ 100ν μƒμ„± | ~$1.50 |
| **μ΄ν•©** | | | **~$2/μ›”** |

---

## 7. λ‹¤μ λ‹¨κ³„ (μ¦‰μ‹ μ‹¤ν–‰ κ°€λ¥)

### 7.1 Phase 1 μ‹μ‘: μ¤ν‚¤λ§ μ •μ

```bash
# μƒ νμΌ μƒμ„±
rag/
β”β”€β”€ __init__.py
β”β”€β”€ schema.py      # λ°μ΄ν„° μ¤ν‚¤λ§
β””β”€β”€ converter.py   # κΈ°μ΅΄ λ°μ΄ν„° λ³€ν™
```

### 7.2 μ²« λ²μ§Έ μ‘μ—…

1. `rag/schema.py` μ‘μ„± - Pydantic λ¨λΈ μ •μ
2. κΈ°μ΅΄ `_data.json` β†’ RAG μ¤ν‚¤λ§ λ³€ν™ λ΅μ§
3. ν…μ¤νΈ: ν„μ¬ νμ‹±λ λ°μ΄ν„°λ΅ λ³€ν™ ν…μ¤νΈ

---

## 8. μ§λ¬Έ μ‚¬ν•­ (κµ¬ν„ μ „ ν™•μΈ ν•„μ”)

1. **κ²€μƒ‰ μ°μ„ μμ„**: μ„±μ  > κ³„μ—΄ > ν•™κµμ ν• μμΌλ΅ ν•„ν„°λ§ν• κΉμ”?
2. **λ΅λ“λ§µ μƒμ„Έλ„**: ν•™λ…„λ³„ νƒκµ¬ μ£Όμ λ§? μ„ΈνΉ μ‘μ„± μμ‹κΉμ§€?
3. **UI ν•„μ” μ—¬λ¶€**: CLIλ§ / μ›Ή UI ν•„μ”
4. **λ‹¤κµ­μ–΄ μ§€μ›**: ν•κµ­μ–΄λ§ / μμ–΄ ν¬ν•¨

---

## 9. μμƒ μΌμ •

| Phase | μ‘μ—… | κΈ°κ°„ |
|-------|------|------|
| 1 | λ°μ΄ν„° μ¤ν‚¤λ§ λ° λ³€ν™ | 1μ£Ό |
| 2 | λ²΅ν„° μΈλ±μ‹± | 1μ£Ό |
| 3 | κ²€μƒ‰ λ΅μ§ | 1μ£Ό |
| 4 | λ΅λ“λ§µ μƒμ„± | 1μ£Ό |
| 5 | API/UI | 1μ£Ό |
| **μ΄ν•©** | | **5μ£Ό** |
